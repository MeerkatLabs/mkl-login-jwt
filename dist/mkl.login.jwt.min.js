/* 
   mkl.login.jwt 0.0.1 
*/

!function(a,b){b.module("mkl.login.jwt",["angular-jwt"]).config(["$httpProvider","jwtInterceptorProvider",function(a,b){b.tokenGetter=["LoginService","config",function(a,b){return a.getJWT(b)}],a.interceptors.push("jwtInterceptor")}]);var c=function(a,c,d,e,f,g,h,i,j){var k=j.refreshTime,l=null,m=j.refreshUrl,n=j.loginUrl,o=j.ignoreUrls,p=!1,q={};q.login=function(b,c){return a({method:"POST",url:n,skipAuthorization:!0,data:{username:b,password:c}}).then(function(a){u(a.data.token),f.$broadcast(i)})};var r=function(){var a=d.invoke(j.displayLogin);return a},s=function(){d.invoke(j.hideLogin)},t=function(){return a({method:"POST",url:m,skipAuthorization:!0,data:{token:g.localStorage.getItem("jwtToken")}}).then(function(a){u(a.data.token)})["catch"](function(){g.localStorage.removeItem("jwtToken"),q.getJWT()})};q.logout=function(){return e(function(a){g.localStorage.removeItem("jwtToken"),c.cancel(l),l=null,f.$emit(i.USER_LOGGED_OUT),a()})},q.getJWT=function(a){if(b.isDefined(a)&&o(a))return"";var c=g.localStorage.getItem("jwtToken")||null;return null===c||"null"===c||"undefined"===c?(p=!0,r().then(function(){return g.localStorage.getItem("jwtToken")})["catch"](function(){return e.reject("Login cancelled")})):h.isTokenExpired(c)?t().then(function(){return g.localStorage.getItem("jwtToken")}):null===l?t().then(function(){return g.localStorage.getItem("jwtToken")}):c};var u=function(a){g.localStorage.setItem("jwtToken",a),null===l&&(l=c(function(){t()},k)),p&&(s(),p=!1)};return q},d=function(){var a=this;this.refreshTime=25e4,this.refreshUrl="",this.loginUrl="",this.ignoreUrls=function(){return!1},this.displayLogin=["$q",function(a){return a.reject("Undefined display login method")}],this.hideLogin=["$q",function(a){return a.reject("Undefined hide login method")}],this.$get=["$http","$interval","$injector","$q","$rootScope","$window","jwtHelper","LOGIN_EVENTS",function(b,d,e,f,g,h,i,j){var k={refreshTime:a.refreshTime,refreshUrl:a.refreshUrl,loginUrl:a.loginUrl,ignoreUrls:a.ignoreUrls,displayLogin:a.displayLogin,hideLogin:a.hideLogin};return new c(b,d,e,f,g,h,i,j,k)}]};b.module("mkl.login.jwt").provider("JWTLoginService",d)}(window,window.angular);
//# sourceMappingURL=mkl.login.jwt.min.js.map